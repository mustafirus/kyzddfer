# **Посібник розробника: Створення системи на ky-format**

## **Вступ**

Цей посібник демонструє процес створення інформаційної системи за допомогою ky-format — декларативної мови для опису метаданих. Ми пройдемо шлях від проектування моделі даних до створення складних, адаптивних користувацьких інтерфейсів. Як приклад буде використано систему управління бібліотекою, яку ми розробили разом.  
Мета цього формату — дозволити розробнику сфокусуватися на бізнес-логіці (Що?), а не на технічній реалізації (Як?), значно прискорюючи розробку.

### **Крок 1: Аналіз та Проектування Предметної Області**

Перш ніж написати перший рядок коду, необхідно зрозуміти, з якими сутностями ми працюємо.

1. **Визначте ключові сутності.** Для бібліотеки це:  
   * Книга (Book)  
   * Автор (Author)  
   * Читач (Member)  
2. **Визначте зв'язки між ними.**  
   * Одна книга має одного автора.  
   * Один автор може мати багато книг.  
   * Читач може взяти багато книг.  
3. **Визначте дії та процеси.**  
   * Видача книги читачеві. Цей процес сам стає сутністю — Видача (BookLoan), яка пов'язує книгу та читача.

На цьому етапі у вас з'являється концептуальна модель даних, готова до перетворення на код.

### **Крок 2: Опис Схеми Даних у секції tables**

Тепер перетворимо нашу модель на фізичну схему бази даних. У ky-format це робиться в секції tables.

#### **2.1. Створення таблиць**

Кожна сутність стає таблицею.  
```
rack ver(1.6)  
  tables  
    authors  
      \# ... поля ...  
    books  
      \# ... поля ...  
    members  
      \# ... поля ...  
    book\_loans  
      \# ... поля ...
```
#### **2.2. Визначення полів та їх типів**

Кожна таблиця наповнюється полями. Поле має ім'я та тип (varchar, text, int, date, timestamp).  
```
    authors  
      full_name varchar(150)  
      birth_date date  
      biography text
```
#### **2.3. Встановлення зв'язків за допомогою ref**

Зв'язки між таблицями реалізуються за допомогою типу ref(table\_name). Це аналог зовнішнього ключа (foreign key) в SQL.  
```
    books  
      author ref(authors) # Посилання на таблицю авторів

    book_loans  
      book ref(books)     # Посилання на книгу  
      member ref(members) # Посилання на читача
```
#### **2.4. Додавання обмежень та атрибутів**

Щоб забезпечити цілісність даних, використовуються прапори (\!) та атрибути.

* **Прапори:**  
  * \!required: Поле не може бути порожнім.  
  * \!unique: Значення в полі має бути унікальним.  
  * \!searchable: Дозволяє повнотекстовий пошук по цьому полю (і по зв'язаних полях).  
* **Атрибути:**  
  * default(...): Значення за замовчуванням.  
  * check(...): Умова перевірки даних.

**Приклад:**  
```
    members  
      full_name varchar(150) !required,searchable  
      email varchar(100) !unique,searchable  
      membership_status varchar(50) !required,searchable default(Active)
```
### **Крок 3: Проектування Інтерфейсу в секції apps**

Коли модель даних готова, можна проектувати користувацькі інтерфейси. Це робиться в секції apps.

#### **3.1. Створення додатків та леяутів**

Система може мати кілька додатків (наприклад, для персоналу та для клієнтів). Кожен додаток складається з набору леяутів (екранів).  
  apps  
    \# Додаток для персоналу бібліотеки  
    library\_staff\_app \!active version(1.4)  
      \# ... леяути для персоналу ...

    \# Додаток для клієнтів бібліотеки (читачів)  
    library\_client\_app \!active version(1.0)  
      \# ... леяути для клієнтів ...

#### **3.2. Ролі леяутів: \!menu, \!detail, \!select**

Леяути виконують різні функції, які визначаються прапорами:

* \!menu: Леяут є пунктом головного меню. Зазвичай це list.  
* \!detail: Леяут використовується для детального перегляду одного запису. Зазвичай це form, який відкривається з list.  
* \!select: Леяут використовується як вікно вибору при редагуванні ref полів.

**Приклад логічної пари:**  
      \# 1\. Список читачів, видимий у меню  
      members\_list \!menu title("Читачі")  
      list table(members)  
        \# ... поля ...

      \# 2\. Детальна форма, що відкривається зі списку  
      member\_details \!detail title("Інформація про Читача")  
      form table(members)  
        \# ... поля ...

### **Крок 4: Створення Адаптивних та "Розумних" Леяутів**

#### **4.1. Адаптивність з media()**

Атрибут media() дозволяє створювати різні версії леяуту для різних пристроїв.  
      \# Леяут для десктопу  
      my\_profile \!default title("Мій кабінет"), media(desktop)  
      \# ...

      \# Леяут для планшету  
      my\_profile\_tab title("Мій кабінет"), media(tab)  
      \# ...

      \# Леяут для телефону  
      my\_profile\_phone title("Мій кабінет"), media(phone)  
      \# ...

#### **4.2. Доступ до пов'язаних даних через крапку**

Це одна з найпотужніших можливостей. Ви можете звертатися до полів пов'язаних таблиць через крапку, створюючи ланцюжки будь-якої довжини.  
**Приклад:** У списку виданих книг (book\_loans) ми хочемо бачити не просто ID автора, а його ім'я та дату народження.  
      active\_loans\_list \!menu title("Активні видачі")  
      list table(book\_loans)  
        book.title              \# Поле з таблиці books  
        book.author.full\_name   \# Поле з таблиці authors, доступне через books  
        member.full\_name        \# Поле з таблиці members

Це дозволяє створювати надзвичайно інформативні звіти та списки без необхідності писати складні SQL-запити.

### **Крок 5: Ітерація та Вдосконалення**

Розробка на ky-format — це ітеративний процес. Визначивши базову структуру, ви можете легко додавати нові поля, таблиці та леяути, поступово нарощуючи функціонал. Наш приклад library\_management.ky пройшов кілька таких ітерацій, збагатившись звітами, фільтрами та адаптивними інтерфейсами.

## **Висновок**

ky-format надає розробнику інструмент для швидкого створення складних систем, описуючи їхню структуру на високому рівні абстракції. Ключові принципи успішної розробки:

1. **Спочатку модель:** Ретельно спроектуйте таблиці та зв'язки.  
2. **Розділяйте ролі:** Чітко визначте, для чого служить кожен леяут (\!menu, \!detail, \!select).  
3. **Використовуйте зв'язки:** Не бійтеся створювати складні ланцюжки доступу до даних (table.ref\_field.field), щоб робити інтерфейси інформативними.  
4. **Думайте про користувача:** Створюйте адаптивні леяути (media()) для зручності на всіх пристроях.

Дотримуючись цих кроків, ви зможете ефективно використовувати всю потужність ky-format.